<canvas id="radarChart" width="400" height="400"></canvas>

<script>
  document.addEventListener("turbo:load", function () {
    const ctx = document.getElementById("radarChart");
    if (!ctx) return;

    if (Chart.getChart(ctx)) {
      Chart.getChart(ctx).destroy();
    }

    const borderWidth = window.innerWidth < 768 ? 2 : 4;

    // ユーザーによってラベルを切り替え
    const labelText = "<%= current_user == @post&.user ? t('defaults.chart.sweetness_user') : t('defaults.chart.sweetness_other_user') %>";

    new Chart(ctx, {
      type: 'radar',
      data: {
        labels: ["甘みの強さ", ["後味のキレ/","スッキリ感"], "自然な甘さ", "爽快感", "甘さの深み/コク"],
        datasets: [{
          label: labelText,
          data: [<%= data.map(&:to_i).join(", ") %>],
          backgroundColor: 'rgba(245, 182, 199, 0.4)',
          borderColor: 'rgba(245, 182, 199, 0.6)',
          borderWidth: borderWidth,
          pointBackgroundColor: 'rgba(245, 182, 199, 0.6)',
          pointRadius: 4,
          pointHoverRadius: 4
        }]
      },
      options: {
        responsive: true,
        scales: {
          r: {
            min: 0,
            max: 5,
            ticks: {
              stepSize: 1
            }
          }
        }
      }
    });
  });
</script>