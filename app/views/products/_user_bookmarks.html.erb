<div class="w-full p-3">
  <% @bookmarks.each do |product| %>
    <!-- カード -->
    <div class="card bg-base-100 p-2 shadow-sm min-h-52 rounded-4xl flex flex-col md:flex-row relative mb-4">
      
      <!-- 画像 -->
      <figure class="flex-shrink-0 w-full md:w-52">
        <% product = product.decorate %>
        <%= product.product_image(class: "w-30 h-30 md:w-40 md:h-40") %>
      </figure>
      
      <!-- 商品情報 -->
      <div class="card-body flex-1 min-w-0 flex flex-col text-neutral justify-between">

        <div class="flex justify-between items-center w-full mb-2">
          <p class="text-xs md:text-base text-base-300 truncate flex-1">
            <%= product.manufacturer %>
          </p>
          <% if user_signed_in? && current_user == @user %>
          <div class="ml-2 flex-shrink-0">
            <%= render 'products/bookmark_buttons', { product: product } %>
          </div>
          <% end %>
        </div>

        <%= link_to product_path(product), class: "flex items-center gap-2 hover:opacity-70" do %>
          <p class="text-sm md:text-xl font-semibold text-left truncate">
            <%= product.name %>
          </p>
        <% end %>

        <% if product.total_posts.zero? %>
          <div class="p-2">
            <div class="ring-base-300 px-5 py-1 md:px-5 md:py-2 text-neutral ring-3 md:ring-4 rounded-xl bg-base-100 
                      flex flex-col md:flex-row items-center gap-2 w-full justify-center md:justify-start">
              <%= image_tag "smiley-blank.svg", class: "h-8 w-8 md:h-10 md:w-10" %>
              <p class="text-xs md:text-base">
                <%= raw t('defaults.label.no_rating') %>
              </p>
            </div>
            <div class="mt-4 md:mt-6 text-center">
              <%= link_to new_post_path(product_id: product.id), 
                  class: "bg-accent rounded-full px-3 py-1 md:px-4 py-3
                          inline-flex items-center shadow-sm transition hover-animation" do %>
                <span class="text-xs md:text-sm">
                  <%= t('defaults.buttons.new_post') %>
                </span>
              <% end %>
            </div>
          </div>
        <% else %>
          <div class="px-1 py-4">
            <div class="ring-primary px-1 py-1 md:px-5 md:py-2 w-fit text-neutral ring-3 md:ring-4 rounded-xl bg-base-100 
                        flex flex-col md:flex-row items-center gap-1 md:gap-2 justify-center md:justify-start">
              <%= image_tag "smiley-wink.svg", class: "h-8 w-8 md:h-10 md:w-10" %>
              <p class="text-xs md:text-base pb-1">
                <%= t("defaults.label.stats", count: product.total_posts, 
                  perfect: product.perfect_sweetness_count) %>
              </p>
            </div>
          </div>
        <% end %>

      </div>
    </div>
  <% end %>
</div>
